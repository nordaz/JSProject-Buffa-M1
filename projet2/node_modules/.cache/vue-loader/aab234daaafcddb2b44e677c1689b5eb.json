{"remainingRequest":"C:\\Users\\nazdo\\OneDrive\\Documents\\M1_MIAGE\\JS\\PROJET2\\projet2\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\nazdo\\OneDrive\\Documents\\M1_MIAGE\\JS\\PROJET2\\projet2\\src\\components\\ListeDesRestaurants.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\nazdo\\OneDrive\\Documents\\M1_MIAGE\\JS\\PROJET2\\projet2\\src\\components\\ListeDesRestaurants.vue","mtime":1604847208863},{"path":"C:\\Users\\nazdo\\OneDrive\\Documents\\M1_MIAGE\\JS\\PROJET2\\projet2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\nazdo\\OneDrive\\Documents\\M1_MIAGE\\JS\\PROJET2\\projet2\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\nazdo\\OneDrive\\Documents\\M1_MIAGE\\JS\\PROJET2\\projet2\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\nazdo\\OneDrive\\Documents\\M1_MIAGE\\JS\\PROJET2\\projet2\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgXyBmcm9tICJsb2Rhc2giOw0KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICJMaXN0ZURlc1Jlc3RhdXJhbnRzIiwNCiAgZGF0YTogKCkgPT4gew0KICAgIHJldHVybiB7DQogICAgICByZXN0YXVyYW50czogW10sDQogICAgICBub206ICIiLA0KICAgICAgY3Vpc2luZTogIiIsDQogICAgICBuYlJlc3RhdXJhbnRzVG90YWw6IDAsDQogICAgICBwYWdlOiAwLA0KICAgICAgcGFnZXNpemU6IDEwLA0KICAgICAgbmJQYWdlc1RvdGFsOiAwLA0KICAgICAgbXNnOiAiIiwNCiAgICAgIG5vbVJlc3RhdVJlY2hlcmNoZTogIiIsDQogICAgfTsNCiAgfSwNCg0KICBtb3VudGVkKCkgew0KICAgIC8vIGB0aGlzYCBwb2ludHMgdG8gdGhlIHZtIGluc3RhbmNlDQogICAgY29uc29sZS5sb2coIlRlc3QgUmVzdGF1cmFudHMgcHJvamV0Iik7DQogICAgdGhpcy5nZXRSZXN0YXVyYW50c0Zyb21TZXJ2ZXIoKTsNCiAgfSwNCiAgbWV0aG9kczogew0KICAgIHBhZ2VQcmVjZWRlbnRlKCkgew0KICAgICAgaWYgKHRoaXMucGFnZSA9PT0gMCkgcmV0dXJuOw0KDQogICAgICB0aGlzLnBhZ2UtLTsNCiAgICAgIHRoaXMuZ2V0UmVzdGF1cmFudHNGcm9tU2VydmVyKCk7DQogICAgfSwNCiAgICBwYWdlU3VpdmFudGUoKSB7DQogICAgICBpZiAodGhpcy5wYWdlID09PSB0aGlzLmRlcm5pZXJlUGFnZSkgcmV0dXJuOw0KDQogICAgICB0aGlzLnBhZ2UrKzsNCiAgICAgIHRoaXMuZ2V0UmVzdGF1cmFudHNGcm9tU2VydmVyKCk7DQogICAgfSwNCiAgICBnZXRSZXN0YXVyYW50c0Zyb21TZXJ2ZXIoKSB7DQogICAgICBsZXQgdXJsID0gImh0dHA6Ly9sb2NhbGhvc3Q6ODA4MC9hcGkvcmVzdGF1cmFudHM/IjsNCiAgICAgIHVybCArPSAicGFnZT0iICsgdGhpcy5wYWdlOw0KICAgICAgdXJsICs9ICImcGFnZXNpemU9IiArIHRoaXMucGFnZXNpemU7DQogICAgICB1cmwgKz0gIiZuYW1lPSIgKyB0aGlzLm5vbVJlc3RhdVJlY2hlcmNoZTsNCg0KICAgICAgZmV0Y2godXJsKQ0KICAgICAgICAudGhlbigocmVzcG9uc2VKU09OKSA9PiB7DQogICAgICAgICAgLy9hcnJvdyBmdW5jdGlvbnMgY29uc2VydmUgbGUgYm9uICJ0aGlzIg0KICAgICAgICAgIC8vIGxhIHLDqXBvbnNlIGVzdCBlbiBKU09OIG9uIGxhIGNvbnZlcnRpdCBhdmVjIGxhIGxpZ25lIHN1aXZhbnRlDQogICAgICAgICAgcmVzcG9uc2VKU09OLmpzb24oKS50aGVuKChyZXNKUykgPT4gew0KICAgICAgICAgICAgLy8gTWFpbnRlbmFudCByZXMgZXN0IHVuIHZyYWkgb2JqZXQgSmF2YVNjcmlwdA0KICAgICAgICAgICAgdGhpcy5yZXN0YXVyYW50cyA9IHJlc0pTLmRhdGE7DQogICAgICAgICAgICB0aGlzLm5iUmVzdGF1cmFudHNUb3RhbCA9IHJlc0pTLmNvdW50Ow0KICAgICAgICAgICAgdGhpcy5uYlBhZ2VzVG90YWwgPSBNYXRoLnJvdW5kKA0KICAgICAgICAgICAgICB0aGlzLm5iUmVzdGF1cmFudHNUb3RhbCAvIHRoaXMucGFnZXNpemUNCiAgICAgICAgICAgICk7DQogICAgICAgICAgfSk7DQogICAgICAgIH0pDQogICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7DQogICAgICAgICAgY29uc29sZS5sb2coZXJyKTsNCiAgICAgICAgfSk7DQogICAgfSwNCiAgICBjaGVyY2hlclJlc3RhdXJhbnRzOiBfLmRlYm91bmNlKGZ1bmN0aW9uICgpIHsNCiAgICAgIC8vYXBwZWzDqWUgcXVlIHNpIG9uIG4nYSBwYXMgdGFww6kgZGUgdG91Y2hlcyBwZW5kYW50IHVuIGNlcnRhaW4gZMOpbGFpDQogICAgICB0aGlzLmdldFJlc3RhdXJhbnRzRnJvbVNlcnZlcigpOw0KICAgIH0sIDMwMCksDQogICAgc3VwcHJpbWVyUmVzdGF1cmFudChyKSB7DQogICAgICBsZXQgdXJsID0gImh0dHA6Ly9sb2NhbGhvc3Q6ODA4MC9hcGkvcmVzdGF1cmFudHMvIiArIHIuX2lkOw0KICAgICAgZmV0Y2godXJsLCB7DQogICAgICAgIG1ldGhvZDogIkRFTEVURSIsDQogICAgICB9KQ0KICAgICAgICAudGhlbigocmVzcG9uc2VKU09OKSA9PiB7DQogICAgICAgICAgcmVzcG9uc2VKU09OLmpzb24oKS50aGVuKChyZXNKUykgPT4gew0KICAgICAgICAgICAgLy8gTWFpbnRlbmFudCByZXMgZXN0IHVuIHZyYWkgb2JqZXQgSmF2YVNjcmlwdA0KICAgICAgICAgICAgY29uc29sZS5sb2cocmVzSlMubXNnKTsNCiAgICAgICAgICAgIHRoaXMubXNnID0gcmVzSlMubXNnOw0KICAgICAgICAgICAgLy8gT24gcmFmcmFpY2hpdCBsYSB2dWUNCiAgICAgICAgICAgIHRoaXMuZ2V0UmVzdGF1cmFudHNGcm9tU2VydmVyKCk7DQogICAgICAgICAgfSk7DQogICAgICAgIH0pDQogICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7DQogICAgICAgICAgY29uc29sZS5sb2coZXJyKTsNCiAgICAgICAgfSk7DQogICAgfSwNCiAgICBham91dGVyUmVzdGF1cmFudChldmVudCkgew0KICAgICAgLy8gUsOpY3Vww6lyYXRpb24gZHUgZm9ybXVsYWlyZS4gUGFzIGJlc29pbiBkZSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yDQogICAgICAvLyBvdSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCBwdWlzcXVlIGMnZXN0IGxlIGZvcm11bGFpcmUgcXVpIGEgZ8OpbsOpcsOpDQogICAgICAvLyBsJ8OpdsOpbmVtZW50DQoNCiAgICAgIGxldCBmb3JtID0gZXZlbnQudGFyZ2V0Ow0KDQogICAgICAvLyBSw6ljdXDDqXJhdGlvbiBkZXMgdmFsZXVycyBkZXMgY2hhbXBzIGR1IGZvcm11bGFpcmUNCiAgICAgIC8vIGVuIHByw6l2aXNpb24gZCd1biBlbnZvaSBtdWx0aXBhcnQgZW4gYWpheC9mZXRjaA0KICAgICAgbGV0IGRvbm5lZXNGb3JtdWxhaXJlID0gbmV3IEZvcm1EYXRhKGZvcm0pOw0KDQogICAgICBsZXQgdXJsID0gImh0dHA6Ly9sb2NhbGhvc3Q6ODA4MC9hcGkvcmVzdGF1cmFudHM/IjsNCg0KICAgICAgZmV0Y2godXJsLCB7DQogICAgICAgIG1ldGhvZDogIlBPU1QiLA0KICAgICAgICBib2R5OiBkb25uZWVzRm9ybXVsYWlyZSwNCiAgICAgIH0pDQogICAgICAgIC50aGVuKChyZXNwb25zZUpTT04pID0+IHsNCiAgICAgICAgICByZXNwb25zZUpTT04uanNvbigpLnRoZW4oKHJlc0pTKSA9PiB7DQogICAgICAgICAgICAvLyBNYWludGVuYW50IHJlcyBlc3QgdW4gdnJhaSBvYmpldCBKYXZhU2NyaXB0DQogICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNKUy5tc2cpOw0KICAgICAgICAgICAgdGhpcy5tc2cgPSByZXNKUy5tc2c7DQogICAgICAgICAgICAvLyBPbiByYWZyYWljaGl0IGxhIHZ1ZQ0KICAgICAgICAgICAgdGhpcy5nZXRSZXN0YXVyYW50c0Zyb21TZXJ2ZXIoKTsNCiAgICAgICAgICB9KTsNCiAgICAgICAgfSkNCiAgICAgICAgLmNhdGNoKChlcnIpID0+IHsNCiAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpOw0KICAgICAgICB9KTsNCg0KICAgICAgdGhpcy5ub20gPSAiIjsNCiAgICAgIHRoaXMuY3Vpc2luZSA9ICIiOw0KICAgIH0sDQogICAgZ2V0Q29sb3IoZXZlbnQpIHsNCiAgICAgIHJldHVybiBldmVudCAlIDIgPyAibGlnaHRCbHVlIiA6ICJwaW5rIjsNCiAgICB9LA0KICB9LA0KfTsNCg=="},{"version":3,"sources":["ListeDesRestaurants.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4HA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ListeDesRestaurants.vue","sourceRoot":"src/components","sourcesContent":["<template>\r\n  <div>\r\n    <h1 style=\"text-align: center\">Liste de restaurants</h1>\r\n\r\n    <form @submit.prevent=\"ajouterRestaurant($event)\">\r\n      <label>\r\n        Nom : <input v-model=\"nom\">\r\n      </label>\r\n      <label>\r\n        Cuisine : <input v-model=\"cuisine\">\r\n      </label>\r\n      <button>Ajouter</button>\r\n    </form>\r\n\r\n    <h2>Nombre de restaurants : {{ nbRestaurantsTotal }}</h2>\r\n\r\n    <p>Nb de pages total : {{ nbPagesTotal }}</p>\r\n    <p>\r\n      Nb restaurants par page :\r\n      <input\r\n        @change=\"getRestaurantsFromServer()\"\r\n        type=\"range\"\r\n        min=\"2\"\r\n        max=\"100\"\r\n        v-model=\"pagesize\"\r\n      />{{ pagesize }}\r\n    </p>\r\n    <p class=\"buttons\">\r\n      <span>&nbsp; Page courante : {{ page }}</span>\r\n      <md-button\r\n        class=\"md-raised md-accent\"\r\n        :disabled=\"page === 0\"\r\n        @click=\"pagePrecedente()\"\r\n        >Precedent</md-button\r\n      >&nbsp;&nbsp;\r\n      <md-button\r\n        class=\"md-raised md-accent\"\r\n        :disabled=\"page === nbPagesTotal\"\r\n        @click=\"pageSuivante()\"\r\n      >\r\n        Suivant\r\n      </md-button>\r\n    </p>\r\n\r\n\r\n    <input\r\n      @input=\"chercherRestaurants()\"\r\n      type=\"text\"\r\n      v-model=\"nomRestauRecherche\"\r\n    />\r\n\r\n    <md-table>\r\n      <md-table-row\r\n        v-for=\"(r, index) in restaurants\"\r\n        :key=\"index\"\r\n        v-on:click=\"supprimerRestaurant(r)\"\r\n        v-bind:style=\"{ backgroundColor: getColor(index) }\"\r\n        v-bind:class=\"{ bordureRouge: index === 2 }\"\r\n      >\r\n        <md-table-cell>{{ r.name }}</md-table-cell>\r\n        <md-table-cell>{{ r.cuisine }}</md-table-cell>\r\n        <md-table-cell>{{ r.borough }}</md-table-cell>\r\n      </md-table-row>\r\n    </md-table>\r\n\r\n    <!--\r\n    <md-table\r\n      v-model=\"restaurants\"\r\n      md-sort=\"name\"\r\n      md-sort-order=\"asc\"\r\n      md-card\r\n      md-fixed-header\r\n    >\r\n      <md-table-toolbar>\r\n        <md-field md-clearable class=\"md-toolbar-section-end\">\r\n          <md-input\r\n            placeholder=\"Nom, Cuisine, Ville...\"\r\n            @input=\"chercherRestaurants()\"\r\n            type=\"text\"\r\n            v-model=\"nomRestauRecherche\"\r\n          />\r\n        </md-field>\r\n      </md-table-toolbar>\r\n\r\n      <md-table-empty-state\r\n        md-label=\"Aucun restaurant, cuisine ou ville trouvé...\"\r\n        :md-description=\"`Aucun restaurant ne correspond à votre recherche ${nomRestauRecherche}. Essayer un autre restaurant ...`\"\r\n      >\r\n      </md-table-empty-state>\r\n\r\n      <md-table-row>\r\n        <md-table-head>Nom</md-table-head>\r\n        <md-table-head>Cuisine</md-table-head>\r\n        <md-table-head>Ville</md-table-head>\r\n      </md-table-row>\r\n\r\n      <md-table-row\r\n        slot=\"md-table-row\"\r\n        slot-scope=\"{ item, index }\"\r\n        :style=\"{ backgroundColor: getColor(index) }\"\r\n        :class=\"{ bordureRouge: index === 2 }\"\r\n      >\r\n        <md-table-cell md-label=\"Name\" md-sort-by=\"name\" md-numeric>{{\r\n          item.name\r\n        }}</md-table-cell>\r\n        <md-table-cell md-label=\"Cuisine\" md-sort-by=\"cuisine\" md-numeric>{{\r\n          item.cuisine\r\n        }}</md-table-cell>\r\n        <md-table-cell md-label=\"Borough\" md-sort-by=\"borough\" md-numeric>{{\r\n          item.borough\r\n        }}</md-table-cell>\r\n        <md-table-cell md-label=\"Action\">\r\n          <router-link :to=\"'/restaurant/' + item._id\"> [Details]</router-link>\r\n        </md-table-cell>\r\n        <md-table-cell>\r\n          <md-button v-on:click=\"supprimerRestaurant(item)\" class=\"md-raised\">Supprimer</md-button>\r\n        </md-table-cell>\r\n      </md-table-row>\r\n    </md-table>\r\n    -->\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport _ from \"lodash\";\r\n\r\nexport default {\r\n  name: \"ListeDesRestaurants\",\r\n  data: () => {\r\n    return {\r\n      restaurants: [],\r\n      nom: \"\",\r\n      cuisine: \"\",\r\n      nbRestaurantsTotal: 0,\r\n      page: 0,\r\n      pagesize: 10,\r\n      nbPagesTotal: 0,\r\n      msg: \"\",\r\n      nomRestauRecherche: \"\",\r\n    };\r\n  },\r\n\r\n  mounted() {\r\n    // `this` points to the vm instance\r\n    console.log(\"Test Restaurants projet\");\r\n    this.getRestaurantsFromServer();\r\n  },\r\n  methods: {\r\n    pagePrecedente() {\r\n      if (this.page === 0) return;\r\n\r\n      this.page--;\r\n      this.getRestaurantsFromServer();\r\n    },\r\n    pageSuivante() {\r\n      if (this.page === this.dernierePage) return;\r\n\r\n      this.page++;\r\n      this.getRestaurantsFromServer();\r\n    },\r\n    getRestaurantsFromServer() {\r\n      let url = \"http://localhost:8080/api/restaurants?\";\r\n      url += \"page=\" + this.page;\r\n      url += \"&pagesize=\" + this.pagesize;\r\n      url += \"&name=\" + this.nomRestauRecherche;\r\n\r\n      fetch(url)\r\n        .then((responseJSON) => {\r\n          //arrow functions conserve le bon \"this\"\r\n          // la réponse est en JSON on la convertit avec la ligne suivante\r\n          responseJSON.json().then((resJS) => {\r\n            // Maintenant res est un vrai objet JavaScript\r\n            this.restaurants = resJS.data;\r\n            this.nbRestaurantsTotal = resJS.count;\r\n            this.nbPagesTotal = Math.round(\r\n              this.nbRestaurantsTotal / this.pagesize\r\n            );\r\n          });\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        });\r\n    },\r\n    chercherRestaurants: _.debounce(function () {\r\n      //appelée que si on n'a pas tapé de touches pendant un certain délai\r\n      this.getRestaurantsFromServer();\r\n    }, 300),\r\n    supprimerRestaurant(r) {\r\n      let url = \"http://localhost:8080/api/restaurants/\" + r._id;\r\n      fetch(url, {\r\n        method: \"DELETE\",\r\n      })\r\n        .then((responseJSON) => {\r\n          responseJSON.json().then((resJS) => {\r\n            // Maintenant res est un vrai objet JavaScript\r\n            console.log(resJS.msg);\r\n            this.msg = resJS.msg;\r\n            // On rafraichit la vue\r\n            this.getRestaurantsFromServer();\r\n          });\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        });\r\n    },\r\n    ajouterRestaurant(event) {\r\n      // Récupération du formulaire. Pas besoin de document.querySelector\r\n      // ou document.getElementById puisque c'est le formulaire qui a généré\r\n      // l'événement\r\n\r\n      let form = event.target;\r\n\r\n      // Récupération des valeurs des champs du formulaire\r\n      // en prévision d'un envoi multipart en ajax/fetch\r\n      let donneesFormulaire = new FormData(form);\r\n\r\n      let url = \"http://localhost:8080/api/restaurants?\";\r\n\r\n      fetch(url, {\r\n        method: \"POST\",\r\n        body: donneesFormulaire,\r\n      })\r\n        .then((responseJSON) => {\r\n          responseJSON.json().then((resJS) => {\r\n            // Maintenant res est un vrai objet JavaScript\r\n            console.log(resJS.msg);\r\n            this.msg = resJS.msg;\r\n            // On rafraichit la vue\r\n            this.getRestaurantsFromServer();\r\n          });\r\n        })\r\n        .catch((err) => {\r\n          console.log(err);\r\n        });\r\n\r\n      this.nom = \"\";\r\n      this.cuisine = \"\";\r\n    },\r\n    getColor(event) {\r\n      return event % 2 ? \"lightBlue\" : \"pink\";\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\nh1 {\r\n  color: red;\r\n}\r\n.buttons {\r\n  text-align: right;\r\n  clear: both;\r\n}\r\n.buttons span {\r\n  float: center;\r\n}\r\n\r\n.md-field {\r\n  max-width: 300px;\r\n}\r\n</style>\r\n"]}]}